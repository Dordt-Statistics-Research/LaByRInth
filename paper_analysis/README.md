# Summary
Below is a listing with a brief explanation of each file in this directory. Four datasets (HincII, RsaI, IBM-RIL, Lakin-Fuller) were filtered, masked, imputed, and compared to the original population files to check and compare the accuracy of LB-Impute and LaByRInth. The actual imputed populations resulting from each of these algorithms are not included here due to size restrictions.

# ./results

## ./results/analysis_summary_all_datasets.xlsx
Summary of imputation quality for LB-Impute (36 configurations) and LaByRInth (3 configurations, 3 levels of quality assurance).

## ./results/data_prep.out
R output from filtering and masking the four datasets. Shows what sites (which were not biallelic) were filtered out prior to masking.

# ./data

## ./data/original_files

### ./data/original_files/HincII_FilteredVariants_Cleaned2.vcf.gz

Downloaded from https://github.com/dellaporta-laboratory/LB-Impute/raw/master/example_data/GBS_data/F2/HincII_FilteredVariants_Cleaned2.vcf.gz on 8-5-2018. The program TASSEL 5 (version 20170406) was not able to display the file due to a disordering. The 'Sort Genotype File' plugin in the 'Data' menu of TASSEl 5 was used to order the file which was saved as './data/original_files/HincII_ordered.vcf.gz'. This is an F2 population.

### ./data/original_files/HincII_ordered.vcf.gz

See description for './data/original_files/HincII_FilteredVariants_Cleaned2.vcf.gz'.

### ./data/original_files/RsaI_FilteredVariants_Cleaned2.vcf.gz

Downloaded from https://github.com/dellaporta-laboratory/LB-Impute/raw/master/example_data/GBS_data/F2/RsaI_FilteredVariants_Cleaned2.vcf.gz on 8-5-2018. The program TASSEL 5 (version 20170406) was not able to display the file due to a disordering. The 'Sort Genotype File' plugin in the 'Data' menu of TASSEl 5 was used to order the file which was saved as './data/original_files/RsaI_ordered.vcf.gz'. This is an F2 population.

### ./data/original_files/RsaI_ordered.vcf.gz

See description for './data/original_files/RsaI_FilteredVariants_Cleaned2.vcf.gz'.

### ./data/original_files/IBM_RIL_FinalScaffoldRemoved.vcf.gz

Downloaded from https://github.com/dellaporta-laboratory/LB-Impute/raw/master/example_data/GBS_data/IBM_RIL/IBM_RIL_FinalScaffoldRemoved.vcf.gz on 8-5-2018. The program TASSEL 5 (version 20170406) was not able to display the file due to a disordering. The 'Sort Genotype File' plugin in the 'Data' menu of TASSEl 5 was used to order the file which was saved as './data/original_files/IBM-RIL_ordered.vcf.gz'. This is an RIL population.

### ./data/original_files/IBM-RIL_ordered.vcf.gz

See description for './data/original_files/IBM_RIL_FinalScaffoldRemoved.vcf.gz'.

### ./data/original_files/LakinFuller_GBSv2_20170509.vcf.gz

Obtained from Dr. Jesse Poland in the Kansas State University Department of Agronomy. This is an F5 population.

## ./data/[dataset]

### ./data/[dataset]/LaByRInth/*
Filtered and masked files generated by LaByRInth to be used for imputation.

# ./code
Code files for running the imputation and imputation analysis of the four populations. The code may not run exactly as is because some files have been moved around during the process of building an R package.

## ./code/LB-Impute.jar
Downloaded from https://github.com/dellaporta-laboratory/LB-Impute/blob/master/LB-Impute.jar on August 14, 2018.

## ./code/data_definitions.R
Helper functions for running imputation along with information about the different datasets including the generation and parent names.

## ./code/data_prep.R
Code will ensure proper directories exist for saving imputation files and then generate the filtered and masked datasets for each of the four populations. The "source" commands will not work as the functions have been moved.

## ./code/default_labyrinth_impute.run
Code to run LaByRInth with 3 different genotyping errors on one of the four masked analysis datasets. The code should be run in a shell (as opposed to an R session) and a single parameter should be passed on the command line which should be the name of the dataset to impute without quotation marks (HincII, RsaI, IBM-RIL, or Lakin-Fuller).

## ./code/default_labyrinth_impute_slurm_job.sh
[SLURM](https://slurm.schedmd.com/ "Simple Linux Utility for Resource Management") script for running ./code/default_labyrinth_impute.run on a cluster with SLURM installed.

## ./code/labyrinth_analysis.R
R functions for analyzing the quality of an imputation of a masked file by comparing the result of imputing the mask to the VCF prior to masking.

## ./code/labyrinth_sim.R
Code for masking and mimicking populations. Can be used to mask high quality calls in a VCF file or to generate a simulated population with similar characteristics as the original population.

## ./code/lb-impute_impute.run
Shell script to run ./code/LB-Impute.jar on 36 parameter configurations by first imputing the parents in the dataset as the authors of LB-Impute suggest, then filtering the resulting VCF file, them imputing the progeny.

## ./code/lb-impute_impute_slurm_job.sh
[SLURM](https://slurm.schedmd.com/ "Simple Linux Utility for Resource Management") script for running ./code/lb-impute_impute.run on a cluster with SLURM installed.
